# APISegaAI üöÄ

**APISegaAI** ‚Äî RESTful API –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏, —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∏ —ç–∫—Å–ø–æ—Ä—Ç–∞ —Ç–µ—Å—Ç-–∫–µ–π—Å–æ–≤ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –º–æ–¥–µ–ª–µ–π –º–∞—à–∏–Ω–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è (LLM, —Ç–∞–∫–∏—Ö –∫–∞–∫ Qwen3-32b, Gemma 3-27b) –∏ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å Zephyr Scale. –ü—Ä–æ–µ–∫—Ç –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω –¥–ª—è —É–ø—Ä–æ—â–µ–Ω–∏—è —Å–æ–∑–¥–∞–Ω–∏—è —Ç–µ—Å—Ç-–∫–µ–π—Å–æ–≤, –ø—Ä–æ–≤–µ—Ä–∫–∏ –∏—Ö —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è–º, —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ç–µ—Å—Ç–æ–≤—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏ (datapool) –∏ —ç–∫—Å–ø–æ—Ä—Ç–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –≤ Excel, CSV –∏ Zephyr Scale.

## üìã –û–ø–∏—Å–∞–Ω–∏–µ

–ü—Ä–æ–µ–∫—Ç —Ä–µ–∞–ª–∏–∑—É–µ—Ç —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å –¥–ª—è:
- üß† –ì–µ–Ω–µ—Ä–∞—Ü–∏–∏ —Ç–µ—Å—Ç-–∫–µ–π—Å–æ–≤ –Ω–∞ –æ—Å–Ω–æ–≤–µ –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö (—Ç–µ–∫—Å—Ç–∞, —Ñ–∞–π–ª–æ–≤, URL) —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º LLM.
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∏ —Ç–µ—Å—Ç-–∫–µ–π—Å–æ–≤ –Ω–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è–º —Å —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è–º–∏ –¥–ª—è —É–ª—É—á—à–µ–Ω–∏—è.
- üìä –£–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ç–µ—Å—Ç–æ–≤—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏ (datapool), –≤–∫–ª—é—á–∞—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫—É—é –≥–µ–Ω–µ—Ä–∞—Ü–∏—é –∏ –∑–∞–≥—Ä—É–∑–∫—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö.
- üì§ –≠–∫—Å–ø–æ—Ä—Ç–∞ —Ç–µ—Å—Ç-–∫–µ–π—Å–æ–≤ –∏ –¥–∞–Ω–Ω—ã—Ö –≤ —Ñ–æ—Ä–º–∞—Ç—ã Excel, CSV, Zephyr Scale –∏ Java-–∫–æ–¥ (JUnit/Selenium).
- üìú –í–µ–¥–µ–Ω–∏—è –∏—Å—Ç–æ—Ä–∏–∏ –æ–ø–µ—Ä–∞—Ü–∏–π –Ω–∞–¥ —Ç–µ—Å—Ç-–∫–µ–π—Å–∞–º–∏.

## üèó –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

–ü—Ä–æ–µ–∫—Ç –ø–æ—Å—Ç—Ä–æ–µ–Ω –Ω–∞ –æ—Å–Ω–æ–≤–µ –º–Ω–æ–≥–æ—Å–ª–æ–π–Ω–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã:

- **APISegaAI.Domain** üóÇ:
  - –°–æ–¥–µ—Ä–∂–∏—Ç –¥–æ–º–µ–Ω–Ω—ã–µ —Å—É—â–Ω–æ—Å—Ç–∏ (`TestCase`, `TestStep`, `DataPool`, `DataPoolItem`, `InputData`, `HistoryEntry`) –∏ –ø–µ—Ä–µ—á–∏—Å–ª–µ–Ω–∏—è (`TestCaseStatus`, `DataPoolSource`).
  - –û–ø—Ä–µ–¥–µ–ª—è–µ—Ç –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫—É –∏ –∫–æ–Ω—Ç—Ä–∞–∫—Ç—ã –¥–∞–Ω–Ω—ã—Ö.

- **APISegaAI.DAL** üóÑ:
  - –°–ª–æ–π –¥–æ—Å—Ç—É–ø–∞ –∫ –¥–∞–Ω–Ω—ã–º, –∏—Å–ø–æ–ª—å–∑—É—é—â–∏–π Entity Framework Core –∏ PostgreSQL.
  - –†–µ–∞–ª–∏–∑—É–µ—Ç –ø–∞—Ç—Ç–µ—Ä–Ω Unit of Work –∏ Repository –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å —Å—É—â–Ω–æ—Å—Ç—è–º–∏.
  - –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏: `Npgsql.EntityFrameworkCore.PostgreSQL`, `Microsoft.EntityFrameworkCore.Design`.

- **APISegaAI.Service** ‚öô:
  - –°–æ–¥–µ—Ä–∂–∏—Ç –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫—É –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏, –≤–∞–ª–∏–¥–∞—Ü–∏–∏, —ç–∫—Å–ø–æ—Ä—Ç–∞ —Ç–µ—Å—Ç-–∫–µ–π—Å–æ–≤ –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –¥–∞–Ω–Ω—ã–º–∏.
  - –ò–Ω—Ç–µ–≥—Ä–∏—Ä—É–µ—Ç—Å—è —Å LLM —á–µ—Ä–µ–∑ REST API –∏ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç —Ñ–∞–π–ª—ã —Å –ø–æ–º–æ—â—å—é `ClosedXML` –∏ `HtmlAgilityPack`.
  - –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏: `ClosedXML`, `HtmlAgilityPack`, `Microsoft.Extensions.Http`.

- **APISegaAI (–æ—Å–Ω–æ–≤–Ω–æ–π –ø—Ä–æ–µ–∫—Ç)** üåê:
  - REST API –Ω–∞ ASP.NET Core 7.0 —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π OpenAPI/Swagger.
  - –ö–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä—ã –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ç–µ—Å—Ç-–∫–µ–π—Å–∞–º–∏, —Ç–µ—Å—Ç–æ–≤—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏, —ç–∫—Å–ø–æ—Ä—Ç–æ–º –∏ –∏—Å—Ç–æ—Ä–∏–µ–π.
  - –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏: `Swashbuckle.AspNetCore`, `Microsoft.Extensions.Http.Polly`.

## üõ† –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

- **.NET SDK**: 7.0 üñ•
- **PostgreSQL**: 13+ üóÑ
- **LLM API**: –î–æ—Å—Ç—É–ø –∫ API –º–æ–¥–µ–ª–µ–π (–Ω–∞–ø—Ä–∏–º–µ—Ä, Qwen3-32b, Gemma 3-27b) üåê
- **Zephyr Scale**: –î–æ—Å—Ç—É–ø –∫ REST API Zephyr Scale –¥–ª—è —ç–∫—Å–ø–æ—Ä—Ç–∞ —Ç–µ—Å—Ç-–∫–µ–π—Å–æ–≤ üì§
- **Docker** (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ): –î–ª—è –∑–∞–ø—É—Å–∫–∞ –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞—Ö üê≥

## üîß –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞

### 1. –ö–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è üì•
```bash
git clone https://github.com/your-repo/APISegaAI.git
cd APISegaAI
```

### 2. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –æ–∫—Ä—É–∂–µ–Ω–∏—è ‚öô
1. –°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª `appsettings.json` –≤ –∫–æ—Ä–Ω–µ –æ—Å–Ω–æ–≤–Ω–æ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞:
```json
{
  "ConnectionStrings": {
    "DefaultConnection": "Host=localhost;Port=5432;Database=segaai;Username=your_user;Password=your_password"
  },
  "LlmSettings": {
    "BaseUrl": "https://your-llm-api-endpoint",
    "CertificatePath": "Certificates/your-certificate.cer",
    "MaxTokens": "10000",
    "Temperature": "0.7",
    "TimeoutSeconds": "300",
    "ModelEndpoints": {
        "name-model-ai": "openai/chat/completions",
        "name-model-ai": "openai/chat/completions",
        "name-model-ai": "openai/chat/completions",
        "name-model-ai": "openai/chat/completions"
      }
  },
  "ZephyrSettings": {
    "BaseUrl": "https://api.zephyrscale.com/v2",
    "ApiKey": "your-zephyr-api-key",
    "ProjectKey": "TEST"
  },
  "Logging": {
    "LogLevel": {
      "Default": "Information",
      "Microsoft.AspNetCore": "Warning"
    }
  }
}
```
2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ PostgreSQL –∑–∞–ø—É—â–µ–Ω –∏ –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö —Å–æ–∑–¥–∞–Ω–∞:
```bash
psql -U your_user -c "CREATE DATABASE segaai;"
```

3. –ü—Ä–∏–º–µ–Ω–∏—Ç–µ –º–∏–≥—Ä–∞—Ü–∏–∏ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —Ç–∞–±–ª–∏—Ü:
```bash
cd APISegaAI
dotnet ef migrations add InitialCreate --project ../APISegaAI.DAL
dotnet ef database update --project ../APISegaAI.DAL
```

### 3. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π üì¶
```bash
dotnet restore
```

### 4. –ó–∞–ø—É—Å–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è ‚ñ∂
```bash
cd APISegaAI
dotnet run
```
API –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–Ω–æ –ø–æ –∞–¥—Ä–µ—Å—É `https://localhost:5001` (–∏–ª–∏ –¥—Ä—É–≥–æ–π –ø–æ—Ä—Ç, —É–∫–∞–∑–∞–Ω–Ω—ã–π –≤ `launchSettings.json`).

### 5. –î–æ—Å—Ç—É–ø –∫ Swagger üìñ
–û—Ç–∫—Ä–æ–π—Ç–µ –≤ –±—Ä–∞—É–∑–µ—Ä–µ: `https://localhost:5001/swagger`

## üì¶ –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

### –û—Å–Ω–æ–≤–Ω–æ–π –ø—Ä–æ–µ–∫—Ç (APISegaAI)
- **Microsoft.AspNetCore.OpenApi**: 7.0.20 üìú
- **Microsoft.EntityFrameworkCore.Design**: 7.0.0 üóÑ
- **Microsoft.Extensions.Http.Polly**: 7.0.0 üåê
- **Npgsql.EntityFrameworkCore.PostgreSQL**: 7.0.0 üóÑ
- **Swashbuckle.AspNetCore**: 6.5.0 üìñ
- **Swashbuckle.AspNetCore.Annotations**: 6.5.0 üìñ

### APISegaAI.DAL
- **Microsoft.EntityFrameworkCore.Design**: 7.0.0 üóÑ
- **Microsoft.Extensions.Configuration.Json**: 7.0.0 ‚öô
- **Npgsql.EntityFrameworkCore.PostgreSQL**: 7.0.0 üóÑ

### APISegaAI.Service
- **ClosedXML**: 0.96.0 üìë
- **HtmlAgilityPack**: 1.11.52 üåê
- **Microsoft.AspNetCore.Http.Abstractions**: 2.2.0 üåê
- **Microsoft.Extensions.Http**: 7.0.0 üåê
- **Microsoft.Extensions.Logging.Abstractions**: 7.0.0 üìù

### APISegaAI.Domain
- –ù–µ—Ç –≤–Ω–µ—à–Ω–∏—Ö –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π ‚úÖ

## üåü –û—Å–Ω–æ–≤–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

### –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Ç–µ—Å—Ç-–∫–µ–π—Å–æ–≤ üß†
- –≠–Ω–¥–ø–æ–∏–Ω—Ç: `POST /api/v1/test-cases/generate`
- –ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç —Ç–µ—Å—Ç-–∫–µ–π—Å –∏ JUnit/Selenium-–∫–æ–¥ –Ω–∞ –æ—Å–Ω–æ–≤–µ –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö (—Ç–µ–∫—Å—Ç, —Ñ–∞–π–ª—ã, URL) —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º LLM.
- –ü—Ä–∏–º–µ—Ä –∑–∞–ø—Ä–æ—Å–∞:
```json
{
  "inputData": "–ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ñ–æ—Ä–º—É –ª–æ–≥–∏–Ω–∞ –Ω–∞ —Å–∞–π—Ç–µ https://example.com/login",
  "llmModel": "qwen3-32b-awq"
}
```

### –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ç–µ—Å—Ç–æ–≤—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏ (datapool) üìä
- –≠–Ω–¥–ø–æ–∏–Ω—Ç—ã:
  - `POST /api/v1/datapool/generate` ‚Äî –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö —á–µ—Ä–µ–∑ LLM.
  - `POST /api/v1/datapool/upload` ‚Äî –ó–∞–≥—Ä—É–∑–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö (JSON/CSV).
  - `GET /api/v1/datapool/{id}` ‚Äî –ü–æ–ª—É—á–µ–Ω–∏–µ datapool –ø–æ ID.
  - `GET /api/v1/datapool/by-testcase/{testCaseId}` ‚Äî –ü–æ–ª—É—á–µ–Ω–∏–µ datapool –ø–æ ID —Ç–µ—Å—Ç-–∫–µ–π—Å–∞.

### –≠–∫—Å–ø–æ—Ä—Ç üì§
- –≠–Ω–¥–ø–æ–∏–Ω—Ç—ã:
  - `GET /api/v1/export/testcase/{testCaseId}/excel` ‚Äî –≠–∫—Å–ø–æ—Ä—Ç —Ç–µ—Å—Ç-–∫–µ–π—Å–∞ –≤ Excel.
  - `GET /api/v1/export/datapool/{dataPoolId}/csv` ‚Äî –≠–∫—Å–ø–æ—Ä—Ç —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö –≤ CSV.
  - `POST /api/v1/export/testcase/{testCaseId}/zephyr` ‚Äî –≠–∫—Å–ø–æ—Ä—Ç –≤ Zephyr Scale.
  - `GET /api/v1/export/testcase/{testCaseId}/code` ‚Äî –≠–∫—Å–ø–æ—Ä—Ç JUnit/Selenium-–∫–æ–¥–∞.

### –ò—Å—Ç–æ—Ä–∏—è –æ–ø–µ—Ä–∞—Ü–∏–π üìú
- –≠–Ω–¥–ø–æ–∏–Ω—Ç: `GET /api/v1/history/by-testcase/{testCaseId}`
- –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –∏—Å—Ç–æ—Ä–∏—é –æ–ø–µ—Ä–∞—Ü–∏–π –¥–ª—è —Ç–µ—Å—Ç-–∫–µ–π—Å–∞ (–≥–µ–Ω–µ—Ä–∞—Ü–∏—è, –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ, —ç–∫—Å–ø–æ—Ä—Ç).

## üíª –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Ç–µ—Å—Ç-–∫–µ–π—Å–∞
```bash
curl -X POST "https://localhost:5001/api/v1/test-cases/generate" \
  -H "Content-Type: application/json" \
  -d '{
    "inputData": "–ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ñ–æ—Ä–º—É –ª–æ–≥–∏–Ω–∞ –Ω–∞ —Å–∞–π—Ç–µ https://example.com/login",
    "llmModel": "qwen3-32b-awq"
  }'
```
–û—Ç–≤–µ—Ç:
```json
{
  "testCase": {
    "id": "guid-123",
    "number": "TC-001",
    "name": "–¢–µ—Å—Ç —Ñ–æ—Ä–º—ã –ª–æ–≥–∏–Ω–∞",
    "steps": [
      {
        "stepNumber": 1,
        "action": "–í–≤–µ—Å—Ç–∏ –∏–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è 'testuser'",
        "expectedResult": "–ü–æ–ª–µ –∑–∞–ø–æ–ª–Ω–µ–Ω–æ"
      }
    ],
    "testCode": "@Test\npublic void testLoginForm() {\n  driver.get(\"https://example.com/login\");\n  driver.findElement(By.id(\"username\")).sendKeys(\"testuser\");\n  driver.quit();\n}"
  },
  "recommendation": null
}
```

### –≠–∫—Å–ø–æ—Ä—Ç –≤ Excel
```bash
curl -X GET "https://localhost:5001/api/v1/export/testcase/guid-123/excel" \
  -o "TestCase_guid-123.xlsx"
```

## üõ† –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞

### –ú–∏–≥—Ä–∞—Ü–∏–∏ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
–î–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –Ω–æ–≤–æ–π –º–∏–≥—Ä–∞—Ü–∏–∏:
```bash
cd APISegaAI
dotnet ef migrations add <MigrationName> --project ../APISegaAI.DAL
dotnet ef database update --project ../APISegaAI.DAL
```

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ LLM API
–£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤ `appsettings.json` —É–∫–∞–∑–∞–Ω –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π `LlmSettings:BaseUrl` –∏ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã (`MaxTokens`, `Temperature`).

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Zephyr Scale
–î–æ–±–∞–≤—å—Ç–µ `ZephyrSettings:ApiKey` –∏ `ZephyrSettings:ProjectKey` –≤ `appsettings.json` –¥–ª—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å Zephyr Scale.

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ Swagger UI (`/swagger`) –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —ç–Ω–¥–ø–æ–∏–Ω—Ç–æ–≤.
- –î–ª—è —é–Ω–∏—Ç-—Ç–µ—Å—Ç–æ–≤ –¥–æ–±–∞–≤—å—Ç–µ –ø—Ä–æ–µ–∫—Ç —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º `Moq` –∏ `Microsoft.EntityFrameworkCore.InMemory`.